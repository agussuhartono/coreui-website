const form=document.getElementById('form');let supportActive,supportLevel;const createAlert=(b,c,d)=>{Array.from(b.getElementsByClassName('alert')).forEach(a=>a.remove());const a=document.createElement('div');a.classList.add('alert',`alert-${c}`),a.innerHTML=d,b.appendChild(a)},download=(b,c,d)=>{const a=new XMLHttpRequest;a.open('POST','https://api.coreui.io/downloads/download.php',!0),a.setRequestHeader('Content-type','application/x-www-form-urlencoded'),a.responseType='blob',a.onload=()=>{if(a.readyState===4&&a.status===200){let b="";const c=a.getResponseHeader('Content-Disposition');if(c&&c.indexOf('attachment')!==-1){const d=/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/,a=d.exec(c);a!=null&&a[1]&&(b=a[1].replace(/['"]/g,''))}const e=a.getResponseHeader('Content-Type'),d=new Blob([a.response],{type:e});if(typeof window.navigator.msSaveBlob!='undefined')window.navigator.msSaveBlob(d,b);else{const c=window.URL||window.webkitURL,a=c.createObjectURL(d);if(b){const c=document.createElement('a');typeof c.download=='undefined'?window.location=a:(c.href=a,c.download=b,document.body.appendChild(c),c.click())}else window.location=a;setTimeout(function(){c.revokeObjectURL(a)},100)}}},a.setRequestHeader('Content-type','application/x-www-form-urlencoded'),a.send(JSON.stringify({product:b,name:c,version:d}))},checkLicense=(b,a)=>{if(a.length>1){const c=new XMLHttpRequest;c.open('POST','https://api.coreui.io/downloads/get_list_of_files.php',!0),c.onreadystatechange=()=>{if(c.readyState===4&&c.status===200){const b=JSON.parse(c.responseText),a=b.Transactions.pop();if(parseInt(a.PaymentProvider)===1||parseInt(a.PaymentProvider)===0)form.innerHTML=`Please use the following link to download your order - <a href="https://gumroad.com/purchases/${a.PurchaseID}/receipt">Download</a>`;else{const b=document.createElement('table');b.classList.add('table');const d=document.createElement('thead'),c=document.createElement('tbody');Array.from(['File','Version','Modified','']).forEach(b=>{const a=document.createElement('th');a.appendChild(document.createTextNode(b)),d.appendChild(a)}),a.Download.forEach(d=>{const e=document.createElement('tr'),b=document.createElement('td');b.colSpan=4,b.innerHTML=a.ProductName,b.classList.add('table-light','font-weight-bold'),e.appendChild(b),c.appendChild(e),d.Files.forEach(b=>{const e=document.createElement('tr');for(const[d,c]of Object.entries(b)){const a=document.createElement('td');a.appendChild(document.createTextNode(c)),e.appendChild(a)}const a=document.createElement('button');a.innerHTML='download',a.classList.add('btn','btn-sm','btn-coreui','btn-download'),a.dataset.product=d.Folder,a.dataset.name=b.Name,a.dataset.version=b.Version,a.addEventListener('click',a=>{download(a.target.dataset.product,a.target.dataset.name,a.target.dataset.version)});const f=document.createElement('td');f.appendChild(a),e.appendChild(f),c.appendChild(e)})}),b.appendChild(d),b.appendChild(c),form.innerHTML="",form.parentNode.insertBefore(b,form)}}else createAlert(form,'danger','The license number or email address is invalid.')},c.send(JSON.stringify({email:b,license:a}))}else createAlert(form,'danger','The license number is invalid.')};form.onsubmit=a=>{a.preventDefault(),a.stopPropagation();const b=a.currentTarget,c=b.elements;if(b[0].checkValidity()===!1)b.classList.add('was-validated');else{const a=c.email.value,b=c.license.value;checkLicense(a,b)}}